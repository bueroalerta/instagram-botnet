name:                   test_complex
version:                1
mode:                   distributed



bots:
    -
        username:       ***REMOVED***
        password:       ***REMOVED***
        cookie:         tests/_cookies/***REMOVED***_cookie.json
        cache:          tests/cache.db
        logs:           tests/logs.html

max_per_day:
        likes:          50
        follow:         20
        unfollow:       10

delay:
        like:           10
        usual:          2

filter:

        user:
            followers: x > 50 and x < 1000
            following: x < 500
            is_private: x and False
            is_business: x and False

        media:
            likes:    x < 200
            comments: x < 100
            caption:  any(s not in x for s in ['porn', 'sex'])

        hashtag:
            name:     not in [porn, sex]

        geotag:
            name:     not in {{ cities }}
            lat:      x < 1000 and x > 500
            lng:      x < 1000 and x > 500

actions:

    - describe: follow_followers
      nodes: {{ start_point }}
      edges:
          - followers
          - follow:
               max: 50
                     
    - describe: return_to_reposter
      nodes: {{ start_point }}
      edges:
          - following
          - user_feed
          - filter:
                media:
                    url: not in {{ already_reposted }}  
          - to_chain:
                as: to_repost
                max: 300
                
--- 
# in another file


actions:
    - describe: reposter
      nodes: {{ random.shuffle(to_repost) }}
      edges:
          - filter
          - upload:
                max:   1
                caption:  {{ random.choice(captions) }}
                geotag:   gesuralemme
                usertags: ['***REMOVED***', 'madonna']
              

            
